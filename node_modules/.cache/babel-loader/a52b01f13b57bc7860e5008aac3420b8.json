{"ast":null,"code":"import { isDynamicOutcome, outcomeTranslationLookupKey, parseVariablesFromParams } from './helpers';\nimport { getMarketDefinitions, getSportsLocale } from './locales';\nvar eventDataRequiredErr = new Error('eventData is required for this market name');\nvar aliasMap = {\n  inningnr: 'innings'\n};\n\nfunction applyEventDataToTemplate(template, eventData, enableAbbreviatedTeamName) {\n  var _a, _b, _c, _d;\n\n  var homeName = 'home';\n  var awayName = 'away';\n\n  if (eventData) {\n    homeName = (enableAbbreviatedTeamName ? (_a = eventData.home) === null || _a === void 0 ? void 0 : _a.abbreviation : (_b = eventData.home) === null || _b === void 0 ? void 0 : _b.name) || 'home';\n    awayName = (enableAbbreviatedTeamName ? (_c = eventData.away) === null || _c === void 0 ? void 0 : _c.abbreviation : (_d = eventData.away) === null || _d === void 0 ? void 0 : _d.name) || 'away';\n  }\n\n  var homeRegex = /{{home}}/g;\n  var awayRegex = /{{away}}/g;\n\n  if (homeRegex.test(template)) {\n    template = template.replace(homeRegex, homeName);\n  }\n\n  if (awayRegex.test(template)) {\n    template = template.replace(awayRegex, awayName);\n  }\n\n  return template;\n}\n\nfunction handicapValueDisplay(key, sbvHandicapValue) {\n  var _a;\n\n  var hdp = Number(sbvHandicapValue);\n\n  if (isNaN(hdp)) {\n    return [{}, new Error(\"Please make sure the handicap value \" + sbvHandicapValue + \" is a number\")];\n  }\n\n  var flippedValue = hdp * -1;\n  return [(_a = {}, _a[\"{{\" + key + \"}}\"] = \"\" + (hdp > 0 ? '+' : '') + hdp, _a[\"{{-\" + key + \"}}\"] = \"\" + (flippedValue > 0 ? '+' : '') + flippedValue, _a), null];\n}\n\nfunction applyTemplateVariables(template, marketVariables, eventData, enableAbbreviatedTeamName) {\n  var _a, _b;\n\n  if (!template) {\n    return ['', new Error('missing function arg: template')];\n  }\n\n  var homeName = '';\n  var awayName = '';\n  var marketName = ''; //Specific to outrights\n\n  if (eventData) {\n    homeName = (_a = eventData.home) === null || _a === void 0 ? void 0 : _a.name;\n    awayName = (_b = eventData.away) === null || _b === void 0 ? void 0 : _b.name;\n    marketName = (eventData === null || eventData === void 0 ? void 0 : eventData.name) || '';\n  }\n\n  for (var _i = 0, _c = Object.keys(marketVariables); _i < _c.length; _i++) {\n    var key = _c[_i];\n    var v = marketVariables[key];\n\n    if (!v) {\n      continue;\n    }\n\n    if (v === 'home') {\n      if (!homeName) {\n        return ['', eventDataRequiredErr];\n      }\n\n      v = homeName;\n    } else if (v === 'away') {\n      if (!awayName) {\n        return ['', eventDataRequiredErr];\n      }\n\n      v = awayName;\n    } else if (v === 'market_name') {\n      if (!marketName) {\n        return ['', eventDataRequiredErr];\n      }\n\n      v = marketName;\n    } // This is needed to handle both innings and inngingnr\n\n\n    if (aliasMap[key]) {\n      key = aliasMap[key];\n    }\n\n    if (key === 'handicap') {\n      var _d = handicapValueDisplay(key, v),\n          hdp = _d[0],\n          err = _d[1];\n\n      if (err) {\n        return ['', err];\n      }\n\n      template = template.replace(new RegExp(\"{{-\" + key + \"}}\", 'g'), hdp[\"{{-\" + key + \"}}\"]);\n      template = template.replace(new RegExp(\"{{\" + key + \"}}\", 'g'), hdp[\"{{\" + key + \"}}\"]);\n    } else if (key === 'player' && eventData) {\n      if (eventData.players) {\n        var player = eventData.players[v];\n\n        if (player) {\n          template = template.replace(new RegExp(\"{{\" + key + \"}}\", 'g'), player.name);\n        }\n      }\n    } else {\n      template = template.replace(new RegExp(\"{{\" + key + \"}}\", 'g'), v);\n    }\n  }\n\n  template = applyEventDataToTemplate(template, eventData, enableAbbreviatedTeamName);\n\n  if (template.match(/{{.*}}/)) {\n    return ['', new Error(\"market name \" + template + \" still have tempalate variables\")];\n  }\n\n  return [template, null];\n}\n\nfunction applyOutcomeVariables(template, outcomes, eventData, enableAbbreviatedTeamName) {\n  var _a, _b, _c, _d, _e, _f;\n\n  var outcomeVariables = outcomes;\n  var homeName = 'home';\n  var awayName = 'away';\n\n  if (eventData) {\n    homeName = (enableAbbreviatedTeamName ? (_a = eventData.home) === null || _a === void 0 ? void 0 : _a.abbreviation : (_b = eventData.home) === null || _b === void 0 ? void 0 : _b.name) || ((_c = eventData.home) === null || _c === void 0 ? void 0 : _c.name);\n    awayName = (enableAbbreviatedTeamName ? (_d = eventData.away) === null || _d === void 0 ? void 0 : _d.abbreviation : (_e = eventData.away) === null || _e === void 0 ? void 0 : _e.name) || ((_f = eventData.away) === null || _f === void 0 ? void 0 : _f.name);\n  }\n\n  for (var key in outcomes) {\n    switch (key) {\n      case 'handicap':\n        var _g = handicapValueDisplay(key, outcomeVariables[key]),\n            hdp = _g[0],\n            err = _g[1];\n\n        if (err) {\n          return [outcomeVariables, err];\n        }\n\n        if (template.includes(\"{{\" + key + \"}}\")) {\n          outcomeVariables[key] = hdp[\"{{\" + key + \"}}\"];\n        } else if (template.includes(\"{{-\" + key + \"}}\")) {\n          outcomeVariables[key] = hdp[\"{{-\" + key + \"}}\"];\n        }\n\n        break;\n\n      case 'home':\n        if (!homeName) {\n          return [outcomeVariables, new Error(template + \" requires home name\")];\n        }\n\n        outcomeVariables['team'] = homeName;\n        break;\n\n      case 'away':\n        if (!awayName) {\n          return [outcomeVariables, new Error(template + \" requires away name\")];\n        }\n\n        outcomeVariables['team'] = awayName;\n        break;\n\n      case 'home_pitcher':\n      case 'away_pitcher':\n        {\n          if (!eventData || !eventData.players) {\n            return [outcomeVariables, new Error(template + \" requires player data\")];\n          }\n\n          var name_1 = (eventData.players[outcomeVariables[key]] || {}).name;\n\n          if (!name_1) {\n            name_1 = outcomeVariables[key].replace(/-/g, ' ').replace(/\\w\\S*/g, function (w) {\n              return w.replace(/^\\w/, function (c) {\n                return c.toUpperCase();\n              });\n            });\n          }\n\n          outcomeVariables[key] = name_1;\n          break;\n        }\n\n      default:\n        outcomes[key] = applyEventDataToTemplate(outcomes[key], eventData, enableAbbreviatedTeamName);\n        break;\n    }\n\n    if (outcomeVariables[key].length == 0) {\n      delete outcomeVariables[key];\n    }\n  }\n\n  return [outcomeVariables, null];\n}\n\nfunction getMarketDescription(locale, marketType) {\n  var _a;\n\n  var marketDefinition = getMarketDefinitions(locale);\n  var translation = (_a = marketDefinition[marketType]) === null || _a === void 0 ? void 0 : _a.Description;\n\n  if (!translation) {\n    translation = '';\n  }\n\n  return [translation, null];\n}\n\nfunction getMarketName(locale, selection, marketType, eventData) {\n  if (!selection) {\n    return ['', new Error('no selection in the submarket')];\n  }\n\n  var _a = parseVariablesFromParams(selection.params),\n      variables = _a[0],\n      error = _a[1];\n\n  if (error) {\n    return ['', error];\n  }\n\n  var translations = getMarketDefinitions(locale);\n\n  if (!translations[marketType]) {\n    return ['', new Error(\"missing translation for market \" + marketType)];\n  }\n\n  return applyTemplateVariables(translations[marketType].Name, variables, eventData);\n}\n\nfunction hasMarketDefinition(marketType, locale) {\n  var marketDefinitions = getMarketDefinitions(locale);\n\n  if (!marketDefinitions) {\n    return false;\n  }\n\n  return !!marketDefinitions[marketType];\n}\n\nfunction getOutcome(locale, eventData, marketType, selection, enableAbbreviatedTeamName) {\n  if (!hasMarketDefinition(marketType, locale)) {\n    return [null, new Error(\"missing market definition for market \" + marketType + \" in locale \" + locale)];\n  }\n\n  var marketDefinitions = getMarketDefinitions(locale);\n  var marketDefinition = marketDefinitions[marketType];\n  var dynamic = isDynamicOutcome(marketType, marketDefinition);\n\n  if (!selection) {\n    return [null, new Error('no selection in the submarket')];\n  }\n\n  var _a = parseVariablesFromParams(selection.outcome + \"&\" + selection.params),\n      variables = _a[0],\n      error = _a[1];\n\n  if (error) {\n    return [null, error];\n  }\n\n  var template = marketDefinitions[marketType].Outcomes[outcomeTranslationLookupKey(selection.outcome, dynamic)];\n\n  var _b = applyTemplateVariables(template, variables, eventData, enableAbbreviatedTeamName),\n      name = _b[0],\n      err = _b[1];\n\n  if (err) {\n    return [null, err];\n  }\n\n  var outcomeVariables = applyOutcomeVariables(template, variables, eventData, enableAbbreviatedTeamName)[0];\n  return [{\n    name: name,\n    variables: outcomeVariables\n  }, null];\n}\n\nfunction getSportsName(sportsKey, locale) {\n  sportsKey = sportsKey.trim().replace(/\\s/g, '_').replace(/-/g, '_');\n  return getSportsLocale(locale)[sportsKey];\n}\n\nexport { getSportsName, getMarketName, getOutcome, getMarketDescription, getMarketDefinitions, hasMarketDefinition };","map":{"version":3,"sources":["../../lib/sports-core/market-definitions.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { isDynamicOutcome, outcomeTranslationLookupKey, parseVariablesFromParams, } from './helpers';\nimport { getMarketDefinitions, getSportsLocale } from './locales';\nvar eventDataRequiredErr = new Error('eventData is required for this market name');\nvar aliasMap = {\n    inningnr: 'innings',\n};\nfunction applyEventDataToTemplate(template, eventData, enableAbbreviatedTeamName) {\n    var _a, _b, _c, _d;\n    var homeName = 'home';\n    var awayName = 'away';\n    if (eventData) {\n        homeName =\n            (enableAbbreviatedTeamName\n                ? (_a = eventData.home) === null || _a === void 0 ? void 0 : _a.abbreviation : (_b = eventData.home) === null || _b === void 0 ? void 0 : _b.name) || 'home';\n        awayName =\n            (enableAbbreviatedTeamName\n                ? (_c = eventData.away) === null || _c === void 0 ? void 0 : _c.abbreviation : (_d = eventData.away) === null || _d === void 0 ? void 0 : _d.name) || 'away';\n    }\n    var homeRegex = /{{home}}/g;\n    var awayRegex = /{{away}}/g;\n    if (homeRegex.test(template)) {\n        template = template.replace(homeRegex, homeName);\n    }\n    if (awayRegex.test(template)) {\n        template = template.replace(awayRegex, awayName);\n    }\n    return template;\n}\nfunction handicapValueDisplay(key, sbvHandicapValue) {\n    var _a;\n    var hdp = Number(sbvHandicapValue);\n    if (isNaN(hdp)) {\n        return [\n            {},\n            new Error(\"Please make sure the handicap value \" + sbvHandicapValue + \" is a number\"),\n        ];\n    }\n    var flippedValue = hdp * -1;\n    return [\n        (_a = {},\n            _a[\"{{\" + key + \"}}\"] = \"\" + (hdp > 0 ? '+' : '') + hdp,\n            _a[\"{{-\" + key + \"}}\"] = \"\" + (flippedValue > 0 ? '+' : '') + flippedValue,\n            _a),\n        null,\n    ];\n}\nfunction applyTemplateVariables(template, marketVariables, eventData, enableAbbreviatedTeamName) {\n    var _a, _b;\n    if (!template) {\n        return ['', new Error('missing function arg: template')];\n    }\n    var homeName = '';\n    var awayName = '';\n    var marketName = ''; //Specific to outrights\n    if (eventData) {\n        homeName = (_a = eventData.home) === null || _a === void 0 ? void 0 : _a.name;\n        awayName = (_b = eventData.away) === null || _b === void 0 ? void 0 : _b.name;\n        marketName = (eventData === null || eventData === void 0 ? void 0 : eventData.name) || '';\n    }\n    for (var _i = 0, _c = Object.keys(marketVariables); _i < _c.length; _i++) {\n        var key = _c[_i];\n        var v = marketVariables[key];\n        if (!v) {\n            continue;\n        }\n        if (v === 'home') {\n            if (!homeName) {\n                return ['', eventDataRequiredErr];\n            }\n            v = homeName;\n        }\n        else if (v === 'away') {\n            if (!awayName) {\n                return ['', eventDataRequiredErr];\n            }\n            v = awayName;\n        }\n        else if (v === 'market_name') {\n            if (!marketName) {\n                return ['', eventDataRequiredErr];\n            }\n            v = marketName;\n        }\n        // This is needed to handle both innings and inngingnr\n        if (aliasMap[key]) {\n            key = aliasMap[key];\n        }\n        if (key === 'handicap') {\n            var _d = handicapValueDisplay(key, v), hdp = _d[0], err = _d[1];\n            if (err) {\n                return ['', err];\n            }\n            template = template.replace(new RegExp(\"{{-\" + key + \"}}\", 'g'), hdp[\"{{-\" + key + \"}}\"]);\n            template = template.replace(new RegExp(\"{{\" + key + \"}}\", 'g'), hdp[\"{{\" + key + \"}}\"]);\n        }\n        else if (key === 'player' && eventData) {\n            if (eventData.players) {\n                var player = eventData.players[v];\n                if (player) {\n                    template = template.replace(new RegExp(\"{{\" + key + \"}}\", 'g'), player.name);\n                }\n            }\n        }\n        else {\n            template = template.replace(new RegExp(\"{{\" + key + \"}}\", 'g'), v);\n        }\n    }\n    template = applyEventDataToTemplate(template, eventData, enableAbbreviatedTeamName);\n    if (template.match(/{{.*}}/)) {\n        return [\n            '',\n            new Error(\"market name \" + template + \" still have tempalate variables\"),\n        ];\n    }\n    return [template, null];\n}\nfunction applyOutcomeVariables(template, outcomes, eventData, enableAbbreviatedTeamName) {\n    var _a, _b, _c, _d, _e, _f;\n    var outcomeVariables = outcomes;\n    var homeName = 'home';\n    var awayName = 'away';\n    if (eventData) {\n        homeName =\n            (enableAbbreviatedTeamName\n                ? (_a = eventData.home) === null || _a === void 0 ? void 0 : _a.abbreviation : (_b = eventData.home) === null || _b === void 0 ? void 0 : _b.name) || ((_c = eventData.home) === null || _c === void 0 ? void 0 : _c.name);\n        awayName =\n            (enableAbbreviatedTeamName\n                ? (_d = eventData.away) === null || _d === void 0 ? void 0 : _d.abbreviation : (_e = eventData.away) === null || _e === void 0 ? void 0 : _e.name) || ((_f = eventData.away) === null || _f === void 0 ? void 0 : _f.name);\n    }\n    for (var key in outcomes) {\n        switch (key) {\n            case 'handicap':\n                var _g = handicapValueDisplay(key, outcomeVariables[key]), hdp = _g[0], err = _g[1];\n                if (err) {\n                    return [outcomeVariables, err];\n                }\n                if (template.includes(\"{{\" + key + \"}}\")) {\n                    outcomeVariables[key] = hdp[\"{{\" + key + \"}}\"];\n                }\n                else if (template.includes(\"{{-\" + key + \"}}\")) {\n                    outcomeVariables[key] = hdp[\"{{-\" + key + \"}}\"];\n                }\n                break;\n            case 'home':\n                if (!homeName) {\n                    return [outcomeVariables, new Error(template + \" requires home name\")];\n                }\n                outcomeVariables['team'] = homeName;\n                break;\n            case 'away':\n                if (!awayName) {\n                    return [outcomeVariables, new Error(template + \" requires away name\")];\n                }\n                outcomeVariables['team'] = awayName;\n                break;\n            case 'home_pitcher':\n            case 'away_pitcher': {\n                if (!eventData || !eventData.players) {\n                    return [\n                        outcomeVariables,\n                        new Error(template + \" requires player data\"),\n                    ];\n                }\n                var name_1 = (eventData.players[outcomeVariables[key]] || {}).name;\n                if (!name_1) {\n                    name_1 = outcomeVariables[key]\n                        .replace(/-/g, ' ')\n                        .replace(/\\w\\S*/g, function (w) { return w.replace(/^\\w/, function (c) { return c.toUpperCase(); }); });\n                }\n                outcomeVariables[key] = name_1;\n                break;\n            }\n            default:\n                outcomes[key] = applyEventDataToTemplate(outcomes[key], eventData, enableAbbreviatedTeamName);\n                break;\n        }\n        if (outcomeVariables[key].length == 0) {\n            delete outcomeVariables[key];\n        }\n    }\n    return [outcomeVariables, null];\n}\nfunction getMarketDescription(locale, marketType) {\n    var _a;\n    var marketDefinition = getMarketDefinitions(locale);\n    var translation = (_a = marketDefinition[marketType]) === null || _a === void 0 ? void 0 : _a.Description;\n    if (!translation) {\n        translation = '';\n    }\n    return [translation, null];\n}\nfunction getMarketName(locale, selection, marketType, eventData) {\n    if (!selection) {\n        return ['', new Error('no selection in the submarket')];\n    }\n    var _a = parseVariablesFromParams(selection.params), variables = _a[0], error = _a[1];\n    if (error) {\n        return ['', error];\n    }\n    var translations = getMarketDefinitions(locale);\n    if (!translations[marketType]) {\n        return ['', new Error(\"missing translation for market \" + marketType)];\n    }\n    return applyTemplateVariables(translations[marketType].Name, variables, eventData);\n}\nfunction hasMarketDefinition(marketType, locale) {\n    var marketDefinitions = getMarketDefinitions(locale);\n    if (!marketDefinitions) {\n        return false;\n    }\n    return !!marketDefinitions[marketType];\n}\nfunction getOutcome(locale, eventData, marketType, selection, enableAbbreviatedTeamName) {\n    if (!hasMarketDefinition(marketType, locale)) {\n        return [\n            null,\n            new Error(\"missing market definition for market \" + marketType + \" in locale \" + locale),\n        ];\n    }\n    var marketDefinitions = getMarketDefinitions(locale);\n    var marketDefinition = marketDefinitions[marketType];\n    var dynamic = isDynamicOutcome(marketType, marketDefinition);\n    if (!selection) {\n        return [null, new Error('no selection in the submarket')];\n    }\n    var _a = parseVariablesFromParams(selection.outcome + \"&\" + selection.params), variables = _a[0], error = _a[1];\n    if (error) {\n        return [null, error];\n    }\n    var template = marketDefinitions[marketType].Outcomes[outcomeTranslationLookupKey(selection.outcome, dynamic)];\n    var _b = applyTemplateVariables(template, variables, eventData, enableAbbreviatedTeamName), name = _b[0], err = _b[1];\n    if (err) {\n        return [null, err];\n    }\n    var outcomeVariables = applyOutcomeVariables(template, variables, eventData, enableAbbreviatedTeamName)[0];\n    return [\n        {\n            name: name,\n            variables: outcomeVariables,\n        },\n        null,\n    ];\n}\nfunction getSportsName(sportsKey, locale) {\n    sportsKey = sportsKey.trim().replace(/\\s/g, '_').replace(/-/g, '_');\n    return getSportsLocale(locale)[sportsKey];\n}\nexport { getSportsName, getMarketName, getOutcome, getMarketDescription, getMarketDefinitions, hasMarketDefinition, };\n//# sourceMappingURL=market-definitions.js.map"]},"metadata":{},"sourceType":"module"}