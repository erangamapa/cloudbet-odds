{"ast":null,"code":"import { Locale } from './sports-core-types';\nimport { getMarketDefinitions } from './market-definitions';\nvar dynamicOutcomeMarket = {};\n\nfunction isDynamicOutcome(marketType, marketDefinition) {\n  var cache = dynamicOutcomeMarket[marketType];\n\n  if (typeof cache !== 'undefined') {\n    return cache;\n  }\n\n  var dynamic = Object.keys(marketDefinition.Outcomes).some(function (outcome) {\n    return outcome.includes('dynamic.');\n  });\n  dynamicOutcomeMarket[marketType] = dynamic;\n  return dynamic;\n}\n\nfunction hasLay(submarket) {\n  return submarket.selections.some(function (sel) {\n    return !!sel.side && sel.side.toLowerCase() === 'lay';\n  });\n}\n\nfunction possibleOutcomeCount(marketType) {\n  var marketDefinitions = getMarketDefinitions(Locale.en);\n  var marketDefinition = marketDefinitions[marketType];\n\n  if (!marketDefinition) {\n    return [0, new Error(\"unknown market type \" + marketType)];\n  }\n\n  if (isDynamicOutcome(marketType, marketDefinition)) {\n    return [0, new Error(\"undefined number of possible outcomes for dynamic market \" + marketType)];\n  }\n\n  return [Object.keys(marketDefinition.Outcomes).length, null];\n}\n\nfunction selectionCountPerLine(marketType, submarket) {\n  var marketDefinitions = getMarketDefinitions(Locale.en);\n  var marketDefinition = marketDefinitions[marketType];\n  var falsyReturnValue = {\n    count: 0,\n    hasLay: false\n  };\n\n  if (!marketDefinition) {\n    return [falsyReturnValue, new Error(\"unknown market type \" + marketType)];\n  }\n\n  var lay = hasLay(submarket);\n\n  if (isDynamicOutcome(marketType, marketDefinition)) {\n    return [{\n      count: submarket.selections.length,\n      hasLay: lay\n    }, null];\n  }\n\n  var outcomes = Object.keys(marketDefinition.Outcomes);\n\n  if (outcomes.length < 1) {\n    return [falsyReturnValue, new Error('market definition is missing outcomes')];\n  }\n\n  var count = outcomes.length;\n\n  if (lay) {\n    count *= 2;\n  }\n\n  return [{\n    count: count,\n    hasLay: lay\n  }, null];\n}\n\nfunction outcomeTranslationLookupKey(outcome, dynamicOutcome) {\n  var outcomeTranslationKey = outcome.split('&').map(function (param) {\n    var index = param.indexOf('=');\n    return index > -1 ? param.substring(0, index) : param;\n  }).join('_');\n\n  if (dynamicOutcome) {\n    outcomeTranslationKey = \"dynamic.\" + outcomeTranslationKey;\n  }\n\n  return outcomeTranslationKey;\n}\n\nfunction parseVariablesFromParams(params) {\n  return [params.split('&').reduce(function (accumulator, value) {\n    var _a = value.split('='),\n        k = _a[0],\n        v = _a[1];\n\n    accumulator[k] = v ? decodeURIComponent(v) : '';\n    return accumulator;\n  }, {}), null];\n}\n\nfunction overUnderMarket(marketType) {\n  var marketDefinitions = getMarketDefinitions(Locale.en);\n  var marketDefinition = marketDefinitions[marketType];\n  var outcomes = Object.keys(marketDefinition.Outcomes);\n\n  if (outcomes.length !== 2) {\n    return false;\n  }\n\n  return outcomes.includes('over') && outcomes.includes('under');\n}\n\nexport { selectionCountPerLine, isDynamicOutcome, parseVariablesFromParams, outcomeTranslationLookupKey, possibleOutcomeCount, overUnderMarket };","map":{"version":3,"sources":["../../lib/sports-core/helpers.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { Locale } from './sports-core-types';\nimport { getMarketDefinitions } from './market-definitions';\nvar dynamicOutcomeMarket = {};\nfunction isDynamicOutcome(marketType, marketDefinition) {\n    var cache = dynamicOutcomeMarket[marketType];\n    if (typeof cache !== 'undefined') {\n        return cache;\n    }\n    var dynamic = Object.keys(marketDefinition.Outcomes).some(function (outcome) { return outcome.includes('dynamic.'); });\n    dynamicOutcomeMarket[marketType] = dynamic;\n    return dynamic;\n}\nfunction hasLay(submarket) {\n    return submarket.selections.some(function (sel) { return !!sel.side && sel.side.toLowerCase() === 'lay'; });\n}\nfunction possibleOutcomeCount(marketType) {\n    var marketDefinitions = getMarketDefinitions(Locale.en);\n    var marketDefinition = marketDefinitions[marketType];\n    if (!marketDefinition) {\n        return [0, new Error(\"unknown market type \" + marketType)];\n    }\n    if (isDynamicOutcome(marketType, marketDefinition)) {\n        return [0, new Error(\"undefined number of possible outcomes for dynamic market \" + marketType)];\n    }\n    return [Object.keys(marketDefinition.Outcomes).length, null];\n}\nfunction selectionCountPerLine(marketType, submarket) {\n    var marketDefinitions = getMarketDefinitions(Locale.en);\n    var marketDefinition = marketDefinitions[marketType];\n    var falsyReturnValue = {\n        count: 0,\n        hasLay: false\n    };\n    if (!marketDefinition) {\n        return [falsyReturnValue, new Error(\"unknown market type \" + marketType)];\n    }\n    var lay = hasLay(submarket);\n    if (isDynamicOutcome(marketType, marketDefinition)) {\n        return [{\n                count: submarket.selections.length,\n                hasLay: lay\n            }, null];\n    }\n    var outcomes = Object.keys(marketDefinition.Outcomes);\n    if (outcomes.length < 1) {\n        return [falsyReturnValue, new Error('market definition is missing outcomes')];\n    }\n    var count = outcomes.length;\n    if (lay) {\n        count *= 2;\n    }\n    return [{\n            count: count,\n            hasLay: lay\n        }, null];\n}\nfunction outcomeTranslationLookupKey(outcome, dynamicOutcome) {\n    var outcomeTranslationKey = outcome.split('&').map(function (param) {\n        var index = param.indexOf('=');\n        return index > -1 ? param.substring(0, index) : param;\n    }).join('_');\n    if (dynamicOutcome) {\n        outcomeTranslationKey = \"dynamic.\" + outcomeTranslationKey;\n    }\n    return outcomeTranslationKey;\n}\nfunction parseVariablesFromParams(params) {\n    return [params.split('&').reduce(function (accumulator, value) {\n            var _a = value.split('='), k = _a[0], v = _a[1];\n            accumulator[k] = v ? decodeURIComponent(v) : '';\n            return accumulator;\n        }, {}), null];\n}\nfunction overUnderMarket(marketType) {\n    var marketDefinitions = getMarketDefinitions(Locale.en);\n    var marketDefinition = marketDefinitions[marketType];\n    var outcomes = Object.keys(marketDefinition.Outcomes);\n    if (outcomes.length !== 2) {\n        return false;\n    }\n    return outcomes.includes('over') && outcomes.includes('under');\n}\nexport { selectionCountPerLine, isDynamicOutcome, parseVariablesFromParams, outcomeTranslationLookupKey, possibleOutcomeCount, overUnderMarket };\n//# sourceMappingURL=helpers.js.map"]},"metadata":{},"sourceType":"module"}