{"ast":null,"code":"import _slicedToArray from\"/Users/erangamapa/Projects/market-helper-article/market-helper-example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./styles.css\";import React from\"react\";import{MarketType,getMarket,Locale,getSportsName}from\"@cloudbet/market-helper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function getSport(sport,apiKey){return fetch(\"https://sports-api.cloudbet.com/pub/v2/odds/sports/\".concat(sport),{headers:{\"X-Api-Key\":apiKey,\"cache-control\":\"max-age=600\"}});}function getCompetition(competition,apiKey){return fetch(\"https://sports-api.cloudbet.com/pub/v2/odds/competitions/\".concat(competition),{headers:{\"X-Api-Key\":apiKey,\"cache-control\":\"max-age=600\"}});}var sports=[\"soccer\",\"basketball\",\"tennis\"];var sportMarkets={soccer:[MarketType.soccer_match_odds],basketball:[MarketType.basketball_1x2],tennis:[MarketType.tennis_winner]};export default function App(){var _React$useState=React.useState(\"\"),_React$useState2=_slicedToArray(_React$useState,2),apiKey=_React$useState2[0],setApiKey=_React$useState2[1];var _React$useState3=React.useState(sports[0]),_React$useState4=_slicedToArray(_React$useState3,2),sport=_React$useState4[0],setSport=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),loading=_React$useState6[0],setLoading=_React$useState6[1];var _React$useState7=React.useState([]),_React$useState8=_slicedToArray(_React$useState7,2),competitions=_React$useState8[0],setCompetitions=_React$useState8[1];React.useEffect(function(){if(!sport||!apiKey){return;}setLoading(true);getSport(sport,apiKey).then(function(response){setLoading(false);return response.json();}).then(function(body){setCompetitions(body.categories.flatMap(function(c){return c.competitions;}));});},[apiKey,sport]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{for:\"apiKey\",children:\"API Key\"}),/*#__PURE__*/_jsx(\"input\",{className:\"apikey-field\",type:\"text\",id:\"apiKey\",value:apiKey,onChange:function onChange(e){return setApiKey(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{for:\"sport\",children:\"Sport\"}),/*#__PURE__*/_jsx(\"select\",{value:sport,onChange:function onChange(e){return setSport(e.target.value);},children:sports.map(function(s){return/*#__PURE__*/_jsx(\"option\",{value:s,children:getSportsName(s,Locale.en)});})})]}),loading?/*#__PURE__*/_jsx(Loading,{}):competitions.map(function(c){return/*#__PURE__*/_jsx(Competition,{competition:c,apiKey:apiKey,sportKey:sport},c.key);})]});}function Competition(_ref){var competition=_ref.competition,apiKey=_ref.apiKey,sportKey=_ref.sportKey;var _React$useState9=React.useState([]),_React$useState10=_slicedToArray(_React$useState9,2),events=_React$useState10[0],setEvents=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),loading=_React$useState12[0],setLoading=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),expanded=_React$useState14[0],setExpanded=_React$useState14[1];var loadEvents=function loadEvents(key){setExpanded(function(e){return!e;});if(events.length||loading){return;}setLoading(true);getCompetition(key,apiKey).then(function(response){return response.json();}).then(function(body){setEvents(body.events);setLoading(false);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"competition\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"competition-title\",onClick:function onClick(){return loadEvents(competition.key);},children:competition.name}),expanded&&/*#__PURE__*/_jsx(\"div\",{children:loading?/*#__PURE__*/_jsx(Loading,{}):events.map(function(e){return/*#__PURE__*/_jsx(Event,{event:e,sportKey:sportKey},e.id);})})]});}function Event(_ref2){var event=_ref2.event,sportKey=_ref2.sportKey;var eventMarkets=React.useMemo(function(){var _getMarket=getMarket(event,sportMarkets[sportKey][0]),_getMarket2=_slicedToArray(_getMarket,2),markets=_getMarket2[0],err=_getMarket2[1];if(err){return[];}return markets;},[event,sportKey]);if(!eventMarkets||!eventMarkets.length){return null;}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"event-title\",children:event.name}),eventMarkets.map(function(m){var line=m.lines[0];if(!line){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"selections\",children:line.map(function(outcome){return/*#__PURE__*/_jsxs(\"div\",{className:\"selection\",children:[outcome.name,\" \",/*#__PURE__*/_jsx(\"br\",{}),outcome.back.price]});})});})]});}function Loading(){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"});}","map":{"version":3,"sources":["/Users/erangamapa/Projects/market-helper-article/market-helper-example/src/App.js"],"names":["React","MarketType","getMarket","Locale","getSportsName","getSport","sport","apiKey","fetch","headers","getCompetition","competition","sports","sportMarkets","soccer","soccer_match_odds","basketball","basketball_1x2","tennis","tennis_winner","App","useState","setApiKey","setSport","loading","setLoading","competitions","setCompetitions","useEffect","then","response","json","body","categories","flatMap","c","e","target","value","map","s","en","key","Competition","sportKey","events","setEvents","expanded","setExpanded","loadEvents","length","name","id","Event","event","eventMarkets","useMemo","markets","err","m","line","lines","outcome","back","price","Loading"],"mappings":"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","sourcesContent":["import \"./styles.css\";\nimport React from \"react\";\nimport {\n  MarketType,\n  getMarket,\n  Locale,\n  getSportsName\n} from \"@cloudbet/market-helper\";\nfunction getSport(sport, apiKey) {\n  return fetch(`https://sports-api.cloudbet.com/pub/v2/odds/sports/${sport}`, {\n    headers: {\n      \"X-Api-Key\": apiKey,\n      \"cache-control\": \"max-age=600\"\n    }\n  });\n}\nfunction getCompetition(competition, apiKey) {\n  return fetch(\n    `https://sports-api.cloudbet.com/pub/v2/odds/competitions/${competition}`,\n    {\n      headers: {\n        \"X-Api-Key\": apiKey,\n        \"cache-control\": \"max-age=600\"\n      }\n    }\n  );\n}\nconst sports = [\"soccer\", \"basketball\", \"tennis\"];\nconst sportMarkets = {\n  soccer: [MarketType.soccer_match_odds],\n  basketball: [MarketType.basketball_1x2],\n  tennis: [MarketType.tennis_winner]\n};\nexport default function App() {\n  const [apiKey, setApiKey] = React.useState(\"\");\n  const [sport, setSport] = React.useState(sports[0]);\n  const [loading, setLoading] = React.useState(false);\n  const [competitions, setCompetitions] = React.useState([]);\n  React.useEffect(() => {\n    if (!sport || !apiKey) {\n      return;\n    }\n    setLoading(true);\n    getSport(sport, apiKey)\n      .then((response) => {\n        setLoading(false);\n        return response.json();\n      })\n      .then((body) => {\n        setCompetitions(body.categories.flatMap((c) => c.competitions));\n      });\n  }, [apiKey, sport]);\n\n  return (\n    <div className=\"App\">\n      <div>\n        <label for=\"apiKey\">API Key</label>\n        <input\n          className=\"apikey-field\"\n          type=\"text\"\n          id=\"apiKey\"\n          value={apiKey}\n          onChange={(e) => setApiKey(e.target.value)}\n        />\n      </div>\n      <div>\n        <label for=\"sport\">Sport</label>\n        <select value={sport} onChange={(e) => setSport(e.target.value)}>\n          {sports.map((s) => (\n            <option value={s}>{getSportsName(s, Locale.en)}</option>\n          ))}\n        </select>\n      </div>\n      {loading ? (\n        <Loading />\n      ) : (\n        competitions.map((c) => (\n          <Competition\n            competition={c}\n            apiKey={apiKey}\n            key={c.key}\n            sportKey={sport}\n          />\n        ))\n      )}\n    </div>\n  );\n}\n\nfunction Competition({ competition, apiKey, sportKey }) {\n  const [events, setEvents] = React.useState([]);\n  const [loading, setLoading] = React.useState(false);\n  const [expanded, setExpanded] = React.useState(false);\n  const loadEvents = (key) => {\n    setExpanded((e) => !e);\n    if (events.length || loading) {\n      return;\n    }\n    setLoading(true);\n    getCompetition(key, apiKey)\n      .then((response) => response.json())\n      .then((body) => {\n        setEvents(body.events);\n        setLoading(false);\n      });\n  };\n  return (\n    <div className=\"competition\">\n      <div\n        className=\"competition-title\"\n        onClick={() => loadEvents(competition.key)}\n      >\n        {competition.name}\n      </div>\n      {expanded && (\n        <div>\n          {loading ? (\n            <Loading />\n          ) : (\n            events.map((e) => (\n              <Event event={e} key={e.id} sportKey={sportKey} />\n            ))\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\nfunction Event({ event, sportKey }) {\n  const eventMarkets = React.useMemo(() => {\n    const [markets, err] = getMarket(event, sportMarkets[sportKey][0]);\n    if (err) {\n      return [];\n    }\n    return markets;\n  }, [event, sportKey]);\n  if (!eventMarkets || !eventMarkets.length) {\n    return null;\n  }\n  return (\n    <div>\n      <div className=\"event-title\">{event.name}</div>\n      {eventMarkets.map((m) => {\n        const line = m.lines[0];\n        if (!line) {\n          return null;\n        }\n        return (\n          <div className=\"selections\">\n            {line.map((outcome) => (\n              <div className=\"selection\">\n                {outcome.name} <br />\n                {outcome.back.price}\n              </div>\n            ))}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\nfunction Loading() {\n  return <div className=\"loading\">Loading...</div>;\n}\n"]},"metadata":{},"sourceType":"module"}